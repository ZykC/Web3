// create global `app` namespace
window.app = window.app || {};
// es6 import - notice the capitalized Web3
import Web3 from 'web3';
// initialize web3
window.web3 = new Web3();
// set the provider to our local node
DNSMarketABI = [{"constant":false,"inputs":[{"name":"_newDNSRegistryAddress","type":"address"}],"name":"changeRegistry","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_dns","type":"string"},{"name":"price","type":"uint256"}],"name":"sell","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"sales","outputs":[{"name":"dns","type":"string"},{"name":"seller","type":"address"},{"name":"price","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_saleId","type":"uint256"}],"name":"buy","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"nextSaleId","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"inputs":[{"name":"_DNSRegistryAddress","type":"address"}],"payable":false,"type":"constructor"}]

DNSMarketData = "6060604052600060015534610000576040516020806109ff833981016040528080519060200190919050505b80600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555033600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b505b610940806100bf6000396000f30060606040523615610076576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806315554c551461007b5780638da5cb5b146100ae5780639f656321146100fd578063b5f522f71461015d578063d96a094a1461024a578063deb077b914610267575b610000565b34610000576100ac600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061028a565b005b34610000576100bb6102cf565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b346100005761015b600480803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919080359060200190919050506102f5565b005b346100005761017860048080359060200190919050506105a5565b60405180806020018473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018381526020018281038252858181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156102395780601f1061020e57610100808354040283529160200191610239565b820191906000526020600020905b81548152906001019060200180831161021c57829003601f168201915b505094505050505060405180910390f35b346100005761026560048080359060200190919050506105ee565b005b346100005761027461090e565b6040518082815260200191505060405180910390f35b80600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b50565b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b813373ffffffffffffffffffffffffffffffffffffffff16600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166352876935836000604051602001526040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180806020018281038252838181518152602001915080519060200190808383600083146103cf575b8051825260208311156103cf576020820191506020810190506020830392506103ab565b505050905090810190601f1680156103fb5780820380516001836020036101000a031916815260200191505b5092505050602060405180830381600087803b156100005760325a03f115610000575050506040518051905073ffffffffffffffffffffffffffffffffffffffff1614151561044957610000565b6060604051908101604052808481526020013373ffffffffffffffffffffffffffffffffffffffff168152602001838152506000600060015481526020019081526020016000206000820151816000019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106104e257805160ff1916838001178555610510565b82800160010185558215610510579182015b8281111561050f5782518255916020019190600101906104f4565b5b50905061053591905b80821115610531576000816000905550600101610519565b5090565b505060208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550604082015181600201559050506001600081548092919060010191905055505b5b5b505050565b600060205280600052604060002060009150905080600001908060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060020154905083565b60006000600083815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141561064857610000565b600060008281526020019081526020016000206002015434101561066b57610000565b6000600082815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc60006000848152602001908152602001600020600201549081150290604051809050600060405180830381858888f1935050505050600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166342ba518b60006000848152602001908152602001600020600001336000604051602001526040518363ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180806020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281038252848181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156108345780601f1061080957610100808354040283529160200191610834565b820191906000526020600020905b81548152906001019060200180831161081757829003601f168201915b50509350505050602060405180830381600087803b156100005760325a03f11561000057505050604051805190505060006000828152602001908152602001600020600060008201805460018160011615610100020316600290046000825580601f106108a157506108d8565b601f0160209004906000526020600020908101906108d791905b808211156108d35760008160009055506001016108bb565b5090565b5b506001820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff0219169055600282016000905550505b50565b600154815600a165627a7a72305820b655e2ec27bd9680008c6392842f10ede16382a1fd5cbb2ce9985830cf7aa0e40029"

DNSRegistryABI = [{"constant":false,"inputs":[{"name":"_newDNSRegistryAddress","type":"address"}],"name":"changeRegistry","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_dns","type":"string"},{"name":"price","type":"uint256"}],"name":"sell","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"sales","outputs":[{"name":"dns","type":"string"},{"name":"seller","type":"address"},{"name":"price","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_saleId","type":"uint256"}],"name":"buy","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"nextSaleId","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"inputs":[{"name":"_DNSRegistryAddress","type":"address"}],"payable":false,"type":"constructor"}]

DNSRegistryData = "6060604052600060015534610000576040516020806109fe833981016040528080519060200190919050505b80600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555033600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b505b61093f806100bf6000396000f30060606040523615610076576000357c0100000000000000000000000000000000000000000000000000000000900463ffffffff16806315554c551461007b5780638da5cb5b146100ae5780639f656321146100fd578063b5f522f71461015d578063d96a094a1461024a578063deb077b914610267575b610000565b34610000576100ac600480803573ffffffffffffffffffffffffffffffffffffffff1690602001909190505061028a565b005b34610000576100bb6102cf565b604051808273ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200191505060405180910390f35b346100005761015b600480803590602001908201803590602001908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050919080359060200190919050506102f5565b005b346100005761017860048080359060200190919050506105a4565b60405180806020018473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018381526020018281038252858181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156102395780601f1061020e57610100808354040283529160200191610239565b820191906000526020600020905b81548152906001019060200180831161021c57829003601f168201915b505094505050505060405180910390f35b346100005761026560048080359060200190919050506105ed565b005b346100005761027461090d565b6040518082815260200191505060405180910390f35b80600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505b50565b600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b813373ffffffffffffffffffffffffffffffffffffffff16600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166352876935836000604051602001526040518263ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180806020018281038252838181518152602001915080519060200190808383600083146103cf575b8051825260208311156103cf576020820191506020810190506020830392506103ab565b505050905090810190601f1680156103fb5780820380516001836020036101000a031916815260200191505b5092505050602060405180830381600087803b156100005760325a03f115610000575050506040518051905073ffffffffffffffffffffffffffffffffffffffff1614151561044957610000565b6060604051908101604052808481526020013373ffffffffffffffffffffffffffffffffffffffff168152602001838152506000600060015481526020019081526020016000206000820151816000019080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106104e257805160ff1916838001178555610510565b82800160010185558215610510579182015b8281111561050f5782518255916020019190600101906104f4565b5b50905061053591905b80821115610531576000816000905550600101610519565b5090565b505060208201518160010160006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550604082015181600201559050506001600081548092919060010191905055505b5b505050565b600060205280600052604060002060009150905080600001908060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff16908060020154905083565b60006000600083815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16141561064757610000565b600060008281526020019081526020016000206002015434101561066a57610000565b6000600082815260200190815260200160002060010160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc60006000848152602001908152602001600020600201549081150290604051809050600060405180830381858888f1935050505050600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166342ba518b60006000848152602001908152602001600020600001336000604051602001526040518363ffffffff167c010000000000000000000000000000000000000000000000000000000002815260040180806020018373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020018281038252848181546001816001161561010002031660029004815260200191508054600181600116156101000203166002900480156108335780601f1061080857610100808354040283529160200191610833565b820191906000526020600020905b81548152906001019060200180831161081657829003601f168201915b50509350505050602060405180830381600087803b156100005760325a03f11561000057505050604051805190505060006000828152602001908152602001600020600060008201805460018160011615610100020316600290046000825580601f106108a057506108d7565b601f0160209004906000526020600020908101906108d691905b808211156108d25760008160009055506001016108ba565b5090565b5b506001820160006101000a81549073ffffffffffffffffffffffffffffffffffffffff0219169055600282016000905550505b50565b600154815600a165627a7a72305820cb7b73eea479deafbf57b23ed8a4e5b3b31211764143153512c4ba52c1f6eeef0029"

web3.setProvider(new web3.providers.HttpProvider('http://localhost:8545'));

Meteor.startup(function () {
    web3.eth.defaultAccount = web3.eth.coinbase;

    // connect to contracts here
    // window.dnsMarketContract = window.DNSMarket.at("0xf415a715539fb251ab1138b6eafdac574bed0542");
    // window.dnsRegistryContract = window.DNSRegistry.at("0xdfff65158c6cc4ec105c625ec7ea592897c2c7e7");
    window.dnsMarketContract = web3.eth.contract(DNSMarketABI).at("0xA465a06e1Fa8b592380e501ef783270E5862c99a");
    window.dnsRegistryContract =  web3.eth.contract(DNSRegistryABI).at("0x377f45A6D61300FcA0776eEBD6D2a02b7D12c4bc");
});
